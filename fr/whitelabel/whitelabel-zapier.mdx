---
title: Publication d’une application Zapier
---

## Documentation en marque blanche

Avant de commencer le processus d’enregistrement de l’application Zapier, vous devrez fournir votre propre documentation API, similaire à notre guide ici. Nous hébergeons notre guide sur [Mintlify](https://mintlify.com/), et vous pouvez consulter leur [guide de démarrage rapide](https://mintlify.com/docs/quickstart) pour voir comment faire de même.

Les fichiers de notre documentation sont stockés dans notre [dépôt public Github](https://github.com/ks-collab/innoChat-docs). N’hésitez pas à vous y référer lorsque vous créez la vôtre !

## Configuration initiale

Zapier dispose de son propre guide pour la configuration des intégrations, consultable [ici](https://docs.zapier.com/platform/quickstart/build-integration). Vous pouvez vous référer à leur guide officiel si quelque chose ne fonctionne pas. Sinon, vous pouvez nous contacter.

Dans votre compte Stripe, veuillez définir le booléen `zapier_integration` sur True pour l’activer pour les offres souhaitées. Vous pouvez également visiter les paramètres du forfait gratuit du tableau de bord des partenaires pour activer Zapier pour les utilisateurs gratuits, si nécessaire.

Pour commencer, vous aurez besoin d’un [compte développeur Zapier](https://developer.zapier.com/). Une fois connecté, vous pouvez [créer une nouvelle intégration](https://developer.zapier.com/app/new). Veuillez remplir tous les champs requis dans ce formulaire. Une fois terminé, passez aux étapes suivantes.

## Authentification

Vous devrez configurer une authentification par clé API pour votre intégration. Une fois sélectionnée, vous devez ajouter les deux champs d’authentification suivants dans « Configure your fields ». Si une option n’est pas mentionnée ici, vous n’avez pas besoin de modifier sa valeur par défaut.

1.

   * Type de champ : Field
   * Libellé : Description
   * Clé : description
   * Type : String
   * Requis : Non
   * Texte d’aide : Une description pour aider à identifier votre intégration `<App Name>` dans Zapier.

2.

   * Type de champ : Field
   * Libellé : API Key
   * Clé : api_key
   * Type : String
   * Requis : Oui
   * Texte d’aide : Votre clé API, générée depuis `<App Name>`.

À l’étape suivante, « Configure a Test Request & Connection Label », passez en mode code et utilisez le code suivant comme test :

```js
const options = {
  url: "https://your-domain.com/api/v1/chatbots",
  method: "GET",
  headers: {
    Authorization: `Bearer ${bundle.authData.api_key}`,
  },
};

return z.request(options).then((response) => {
  response.throwForStatus();

  return "success";
});

```

Pour le libellé de connexion, vous pouvez utiliser `{{bundle.authData.description}}`.

<Warning>
  Assurez-vous de remplacer `your-domain.com` par l’URL de votre application en marque blanche.
</Warning>

Lorsque vous arrivez à l’étape « Test your Authentication », créez une clé API dans votre application en marque blanche, puis connectez-la à votre intégration Zapier après avoir cliqué sur « Add new account » dans le menu déroulant. Vous pouvez utiliser le bouton « Test Authentication » pour vérifier la connexion.

## Déclencheurs

Nous n’avons qu’un seul déclencheur ici : la soumission du formulaire du chatbot. Lors de l’ajout d’un nouveau déclencheur, utilisez les paramètres suivants :

* Clé : form_submission

* Nom : Form Submission

* Nom commun : Form

* Description : Se déclenche lorsqu’un utilisateur soumet un formulaire dans un chat.

* Visibilité dans l’éditeur : Shown

Dans l’onglet suivant, ajoutez des champs d’entrée pour l’utilisateur Zapier. Ajoutez le champ chatbot UUID :

* Clé : chatbot_uuid

* Libellé : Chatbot UUID

* Texte d’aide : `Chatbot UUID pour le suivi des soumissions de formulaires. Vous pouvez trouver votre UUID ici : https://your-domain.com/site/chatbot/dashboard.`

* Type: String

* Options: Required doit être sélectionné

Dans l’onglet « API Configuration », définissez le type de déclencheur sur « REST Hook », puis utilisez le code suivant pour « Subscribe » :

```js
const options = {
  url: `https://your-domain.com/api/v1/chatbot/${bundle.inputData.chatbot_uuid}/zapier-subscribe`,
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    Accept: "application/json",
    Authorization: `Bearer ${bundle.authData.api_key}`,
  },
  body: {
    target_url: bundle.targetUrl,
  },
};

return z.request(options).then((response) => {
  response.throwForStatus();
  const results = response.json;

  return results;
});
```

Dans « Unsubscribe » :

```js
const options = {
  url: `https://your-domain.com/api/v1/chatbot/${bundle.inputData.chatbot_uuid}/zapier-unsubscribe`,
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    Accept: "application/json",
    Authorization: `Bearer ${bundle.authData.api_key}`,
  },
  body: {
    hook_id: bundle.subscribeData.hook_id,
  },
};

return z.request(options).then((response) => {
  response.throwForStatus();
  const results = response.json;

  return results;
});
```

Et dans « Perform List » :

```js
const options = {
  url: `https://your-domain.com/api/v1/chatbot/${bundle.inputData.chatbot_uuid}/zapier/poll`,
  method: "GET",
  headers: {
    "Content-Type": "application/json",
    Accept: "application/json",
    Authorization: `Bearer ${bundle.authData.api_key}`,
  },
};

return z.request(options).then((response) => {
  response.throwForStatus();
  const results = response.json;

  return results;
});
```

Ne pas activer la pagination. Dans « Perform », insérez: `return [bundle.cleanedRequest];`.

À ce stade, vous pouvez tester votre déclencheur en créant un Zap.

Pour les données d'exemple dans la dernière section, vous pouvez utiliser le montant minimum disponible. Par exemple, si la plupart des utilisateurs ne collectent que l'adresse e-mail et le numéro de téléphone, et rien d'autre, il vous suffit d'ajouter l'adresse e-mail et le numéro de téléphone :

```json
{
  "Name": "GPT Test",
  "Phone": "+12223334444"
}
```

Ensuite, dans « Champs de sortie », vous pouvez ajouter les clés « Nom » et « Téléphone », qui sont toutes deux des chaînes de caractères. Vous pouvez laisser les étiquettes vides. À ce stade, la configuration du déclencheur est terminée.

## Actions

Nous proposons une seule action permettant d’envoyer un message à un chatbot via un Zap.
Paramètres :

* Type: Create

* Clé : send_message

* Nom : Send Message

* Nom commun : Message

* Description : Envoyer un message à un chatbot et recevoir une réponse.

* Visibilité : Shown

Ajoutez ensuite les champs Chatbot UUID, Query et Session UUID.

### Chatbot UUID

* Clé : chatbot_uuid

* Libellé : Chatbot UUID

* Texte d’aide: `Envoyer un message à un chatbot spécifique. UUID disponible ici : https://your-domain.com/site/chatbot/dashboard.`

* Type: String

* Options: Required

### Query

* Clé : query

* Libellé : Query

* Texte d’aide : Saisissez votre question.

* Type: Text

* Options: Required

### Session UUID

* Clé: session\_uuid

* Libellé : Session UUID

* Texte d’aide : Utilisez un UUID de session pour conserver le contexte.

* Type: String

Enfin, rendez-vous dans l'onglet « Configuration API » pour cette action et utilisez le code suivant pour le point de terminaison API :

```js
const options = {
  url: `https://your-domain.com/api/v1/chatbot/${bundle.inputData.chatbot_uuid}/zapier/message/create`,
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    Accept: "application/json",
    Authorization: `Bearer ${bundle.authData.api_key}`,
  },
  body: {
    query: bundle.inputData.query,
    session_uuid: bundle.inputData.session_uuid,
  },
};

return z.request(options).then((response) => {
  response.throwForStatus();
  const results = response.json;

  return results;
});
```

Vous pouvez tester votre connexion API dans la section suivante pour vérifier si elle fonctionne. Utilisez un UUID de chatbot provenant de votre application en marque blanche.

Enfin, comme nous nous attendons à ce que l'IA ne renvoie qu'un petit bout de texte à partir de cette API, insérez ce qui suit comme exemple de données de sortie :

```json
{
  "response": "Hello! How can I assist you today?"
}
```

Il n'y a qu'un seul champ de sortie, « response », de type « string ».

## Publication

Vous n'avez pas besoin de configurer d'autres paramètres d'intégration après cela et pouvez passer à la publication. Vous devrez créer des Zaps pour tester votre déclencheur et votre action, veuillez donc le faire dans Zapier. De plus, dans la barre latérale droite de l'intégration, vous trouverez une liste des actions que Zapier vous demande d'effectuer avant que votre application puisse être prise en compte pour publication. Veuillez suivre cette liste.

Au cours du processus de publication, vous serez invité à créer un compte sur votre application en marque blanche à l'usage du personnel de Zapier. Si vous avez besoin du code de vérification pour activer ce compte, veuillez nous en informer et nous vous le fournirons.

Une fois votre demande approuvée, votre intégration Zapier devrait disposer d'un lien public. Par exemple, le lien d'innoChat est : [https://zapier.com/apps/innoChat/integrations](https://zapier.com/apps/innoChat/integrations). Vous pouvez coller ce lien dans le tableau de bord des partenaires une fois qu'il est prêt.
